<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React学习笔记 | 嘻哈工程师</title>
    <meta name="description" content="嘻哈工程师的博客">
    <link rel="icon" href="/favicon.ico">
  <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/assets/css/0.styles.f497a715.css" as="style"><link rel="preload" href="/assets/js/app.3e6f12d9.js" as="script"><link rel="preload" href="/assets/js/2.4c1ec6c0.js" as="script"><link rel="preload" href="/assets/js/10.ed8ed320.js" as="script"><link rel="preload" href="/assets/js/5.c16b3c5d.js" as="script"><link rel="prefetch" href="/assets/js/11.5afc6d70.js"><link rel="prefetch" href="/assets/js/12.2b4f7f40.js"><link rel="prefetch" href="/assets/js/13.8f4d0d63.js"><link rel="prefetch" href="/assets/js/14.1b0de918.js"><link rel="prefetch" href="/assets/js/15.8585a8c5.js"><link rel="prefetch" href="/assets/js/16.54eb6852.js"><link rel="prefetch" href="/assets/js/17.e339c0af.js"><link rel="prefetch" href="/assets/js/18.b8eaa725.js"><link rel="prefetch" href="/assets/js/19.a599bc64.js"><link rel="prefetch" href="/assets/js/20.768c03c5.js"><link rel="prefetch" href="/assets/js/21.918110ee.js"><link rel="prefetch" href="/assets/js/22.de92b432.js"><link rel="prefetch" href="/assets/js/23.0db77e28.js"><link rel="prefetch" href="/assets/js/24.7c5b0bef.js"><link rel="prefetch" href="/assets/js/25.2d4b6992.js"><link rel="prefetch" href="/assets/js/26.494364bc.js"><link rel="prefetch" href="/assets/js/27.d61014bb.js"><link rel="prefetch" href="/assets/js/28.451a9ca7.js"><link rel="prefetch" href="/assets/js/29.ae7b835b.js"><link rel="prefetch" href="/assets/js/3.95d078e9.js"><link rel="prefetch" href="/assets/js/30.f1a90140.js"><link rel="prefetch" href="/assets/js/31.24ba14b6.js"><link rel="prefetch" href="/assets/js/32.0609f1ec.js"><link rel="prefetch" href="/assets/js/33.825f2468.js"><link rel="prefetch" href="/assets/js/34.16ec7005.js"><link rel="prefetch" href="/assets/js/35.0edd6115.js"><link rel="prefetch" href="/assets/js/36.e784080a.js"><link rel="prefetch" href="/assets/js/37.caeb8582.js"><link rel="prefetch" href="/assets/js/38.14290d34.js"><link rel="prefetch" href="/assets/js/39.e207580a.js"><link rel="prefetch" href="/assets/js/4.00be0dbc.js"><link rel="prefetch" href="/assets/js/40.3ffb32f3.js"><link rel="prefetch" href="/assets/js/41.44a57f6e.js"><link rel="prefetch" href="/assets/js/42.f352af44.js"><link rel="prefetch" href="/assets/js/43.71a64b79.js"><link rel="prefetch" href="/assets/js/44.367d6457.js"><link rel="prefetch" href="/assets/js/45.1f467d07.js"><link rel="prefetch" href="/assets/js/46.80d7b7b3.js"><link rel="prefetch" href="/assets/js/47.30e5f46c.js"><link rel="prefetch" href="/assets/js/48.30f97b62.js"><link rel="prefetch" href="/assets/js/49.2b7893ba.js"><link rel="prefetch" href="/assets/js/50.f0556ae1.js"><link rel="prefetch" href="/assets/js/51.ac83a51a.js"><link rel="prefetch" href="/assets/js/52.c5805130.js"><link rel="prefetch" href="/assets/js/53.c3ec998c.js"><link rel="prefetch" href="/assets/js/54.59d79f13.js"><link rel="prefetch" href="/assets/js/55.1ff217ce.js"><link rel="prefetch" href="/assets/js/56.7ad495ac.js"><link rel="prefetch" href="/assets/js/57.164ab1cb.js"><link rel="prefetch" href="/assets/js/6.4430b402.js"><link rel="prefetch" href="/assets/js/7.309640e0.js"><link rel="prefetch" href="/assets/js/8.232d57ab.js"><link rel="prefetch" href="/assets/js/9.c81a4fff.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f497a715.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">嘻哈工程师</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">最新</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/shimingw/vpblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">最新</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/shimingw/vpblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ES6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2019-01-13-JavaScript-ES6-ES6学习笔记/" class="sidebar-link">ES6</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/" class="active sidebar-link">React学习笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#表单" class="sidebar-link">表单</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#受控组件" class="sidebar-link">受控组件</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#非受控组件" class="sidebar-link">非受控组件</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#ref" class="sidebar-link">ref</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#组合-vs-继承" class="sidebar-link">组合 vs 继承</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#性能优化" class="sidebar-link">性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#purecomponent" class="sidebar-link">PureComponent</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#diff-keys" class="sidebar-link">diff-keys</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#context" class="sidebar-link">context</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#portals" class="sidebar-link">Portals</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#hoc" class="sidebar-link">HOC</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#hooks" class="sidebar-link">Hooks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#usestate" class="sidebar-link">useState</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#useeffect" class="sidebar-link">useEffect</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#自定义-hook" class="sidebar-link">自定义 hook</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#钩子使用注意事项" class="sidebar-link">钩子使用注意事项</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#prop-types" class="sidebar-link">prop-types</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#redux" class="sidebar-link">redux</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#action" class="sidebar-link">action</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#reducers" class="sidebar-link">reducers</a></li><li class="sidebar-sub-header"><a href="/docs/2019-06-06-JavaScript-React-React学习笔记/#store" class="sidebar-link">store</a></li></ul></li></ul></li><li><a href="/docs/2018-04-15-JavaScript-React-redux/" class="sidebar-link">Redux</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2017-09-06-JavaScript-Vue-Vue笔记/" class="sidebar-link">vue笔记</a></li><li><a href="/docs/2018-07-13-JavaScript-Vue-vue-cli3/" class="sidebar-link">vue-cli3</a></li><li><a href="/docs/2017-12-06-JavaScript-Vue-VueTable/" class="sidebar-link">VueTable学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2019-10-29-JavaScript-其他-深入浅出lodash/" class="sidebar-link">深入浅出lodash</a></li><li><a href="/docs/2019-10-24-JavaScript-其他-代码质量规范/" class="sidebar-link">代码规范</a></li><li><a href="/docs/2018-07-03-JavaScript-其他-函数式编程/" class="sidebar-link">函数式编程</a></li><li><a href="/docs/2018-04-06-JavaScript-其他-深入了解NodeList与HTMLCollection/" class="sidebar-link">深入了解NodeList与HTMLCollection</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>书籍学习笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2018-07-17-JavaScript-书籍学习笔记-JavaScript设计模式/" class="sidebar-link">JavaScript设计模式—笔记</a></li><li><a href="/docs/2020-01-09-JavaScript-书籍学习笔记-javaScript语言精粹—笔记/" class="sidebar-link">JavaScript语言精粹—笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="表单"><a href="#表单" class="header-anchor">#</a> 表单</h2> <h3 id="受控组件"><a href="#受控组件" class="header-anchor">#</a> 受控组件</h3> <p>表单中的组件显示绑定 value 属性，组件中状态的变化，由 react 组件触发 change 方法，最终触发本组件的 setState 方法，进行状态的更新
说白了，表单中用户每个一个输入的值，都会经过程序员写的方法，所以是受控组件</p> <h3 id="非受控组件"><a href="#非受控组件" class="header-anchor">#</a> 非受控组件</h3> <p>表单中输入的数据都由 dom 处理。
用户输入的值是不可控的，用户可以随意输入任何值。</p> <h2 id="ref"><a href="#ref" class="header-anchor">#</a> ref</h2> <p>两种使用方式</p> <blockquote><p>函数式组件无法使用<code>ref</code>属性，只有实例化组件和<strong>html</strong>组件可以使用<code>ref</code></p></blockquote> <ol><li>类似<strong>vue</strong>的用法</li></ol> <div class="language-jsx extra-class"><pre class="language-jsx"><code>为组件定义ref名称
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Card</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>card<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
调用组件实例
<span class="token keyword">this</span><span class="token punctuation">.</span>refs<span class="token punctuation">.</span>card
</code></pre></div><ol start="2"><li>在组件实例化时定义</li></ol> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>card <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Card</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>card<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
调用组件实例
<span class="token keyword">this</span><span class="token punctuation">.</span>card<span class="token punctuation">.</span>current
</code></pre></div><h2 id="组合-vs-继承"><a href="#组合-vs-继承" class="header-anchor">#</a> 组合 vs 继承</h2> <ol><li>react 组件间的复用都采用组合的形式</li> <li>如果组件间有函数（UI 无关的功能）存在复用，建议单独提取成一个 function 进行复用</li></ol> <h2 id="性能优化"><a href="#性能优化" class="header-anchor">#</a> 性能优化</h2> <h3 id="purecomponent"><a href="#purecomponent" class="header-anchor">#</a> PureComponent</h3> <p><code>PureComponent</code>会为<code>shouldComponentUpdate</code>方法提供一个浅比较方法。如果数据没有发生变化，则不会触发 render 方法重新渲染。
但是如果传入的是一个对象，则每次都不会渲染，因为对象的比较是指针。</p> <p>所以不使用突变改变对象，使用 concat，Object.assign，展开运算符等能返回一个新对象的方法进行赋值修改，或者可以使用<code>immutable</code>与<code>PureComponent</code>结合使用。</p> <h2 id="diff-keys"><a href="#diff-keys" class="header-anchor">#</a> diff-keys</h2> <p>当 react 渲染列表时，需要为每一个相同的子组件添加一个 key 属性。
如果没有 key 属性的话，在列表的头部插入一个节点，那么 react 会认为整个列表都需要重新渲染，其实只需要在头部渲染那个新增的节点</p> <p>增加了 key 属性以后，react 会使用 key 来匹配原始树的节点，如果原始的 key 还存在 react 并不会销毁该组件，只会移动或者修改</p> <p>key 必须是唯一的</p> <p>必须要保证每一条数据的 key 都是唯一的，因为如果不唯一，可能会导致子组件数据更新了，然后触发 componentWillReceiveProps 方法去更新其子组件
<strong>但是如果其子组件的状态是通过子组件自身的 state 维护，而非通过 props 进行维护，例如为非受控组件，就会导致该组件无法更新的情况</strong></p> <h2 id="context"><a href="#context" class="header-anchor">#</a> context</h2> <p>原来嵌套组件传值通过 props 一层一层传进去</p> <p>现在通过 context 可以解决这种高度耦合的问题</p> <p><code>const {Provider, Consumer} = React.createContext(defaultValue);</code>
父组件设为<code>&lt;Provider value={/* some value */}&gt;</code>可以用来传递参数，子组件设为<code>&lt;Consumer&gt; {value =&gt; /* render something based on the context value */} &lt;/Consumer&gt;</code>可以用来接收参数</p> <h2 id="portals"><a href="#portals" class="header-anchor">#</a> Portals</h2> <p><code>ReactDOM.createPortal(child, container)</code>
可以将子元素，渲染到指定 dom 节点，而不是默认的父节点中。</p> <p>虽然不在父节点中，但是父节点可以监听到改元素的冒泡时间</p> <h2 id="hoc"><a href="#hoc" class="header-anchor">#</a> HOC</h2> <p>高阶组件，用来将一些组件中相同的功能抽象出来，封装成一个函数，不同的部分作为组件</p> <p>当使用高阶组件时，如果直接在高阶组件上使用 ref，获取到的值，为高阶组件的 ref 而不是我们想获取到的，被封装的组件的 ref。</p> <h2 id="hooks"><a href="#hooks" class="header-anchor">#</a> Hooks</h2> <p>什么是 hook？</p> <p>Hook 是一种特殊功能，可让您“挂钩”React 功能。例如，useState 是一个 Hook，它允许您将 React 状态添加到功能组件。我们稍后会学习其他的 Hook。</p> <p>我什么时候使用 hook？</p> <p>如果你编写一个函数组件并意识到你需要为它添加一些状态，那么之前你必须将它转换为一个类。**现在，您可以在现有功能组件中使用 Hook。**我们现在要做到这一点！</p> <h3 id="usestate"><a href="#usestate" class="header-anchor">#</a> useState</h3> <p>使无状态组件可以使用类的功能
<code>const [count, setCount] = useState(0);</code>返回当前状态和更新它的函数</p> <h3 id="useeffect"><a href="#useeffect" class="header-anchor">#</a> useEffect</h3> <p>使无状态组件可以使用声明周期功能</p> <p>可以取代下面这三个生命周期的功能
componentDidMount, componentDidUpdate, and componentWillUnmount</p> <h4 id="组件更新时触发"><a href="#组件更新时触发" class="header-anchor">#</a> 组件更新时触发</h4> <p>正常情况下，初始化会触发一次<code>useEffect</code>，只要组件更新就会触发<code>useEffect</code></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code>React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Update the document title using the browser API</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You clicked </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> times</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="特定值发生变化时触发"><a href="#特定值发生变化时触发" class="header-anchor">#</a> 特定值发生变化时触发</h4> <p>当不需要每次组件状态更新都触发时，在尾部传入数组可以设置需要监听的值</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You clicked </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> times</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="仅初始化时触发"><a href="#仅初始化时触发" class="header-anchor">#</a> 仅初始化时触发</h4> <p>如果数组中什么值都不传入，那就只会在初始化时触发一次</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You clicked </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> times</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="仅在组件销毁时触发"><a href="#仅在组件销毁时触发" class="header-anchor">#</a> 仅在组件销毁时触发</h4> <p>数组中不传入任何值，并且在钩子中 return 一个函数</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;delete&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="自定义-hook"><a href="#自定义-hook" class="header-anchor">#</a> 自定义 hook</h3> <blockquote><p>自定义挂钩是一种自然遵循 Hooks 设计的约定，而不是 React 功能</p></blockquote> <p>将 hook 封装在一个函数中，使其具有复用性</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span><span class="token parameter">friendID</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isOnline<span class="token punctuation">,</span> setIsOnline<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">handleStatusChange</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setIsOnline</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>isOnline<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ChatAPI<span class="token punctuation">.</span><span class="token function">subscribeToFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ChatAPI<span class="token punctuation">.</span><span class="token function">unsubscribeFromFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> isOnline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="钩子使用注意事项"><a href="#钩子使用注意事项" class="header-anchor">#</a> 钩子使用注意事项</h3> <p>在组件顶层使用 useState 声明钩子，不要在 if 语句中声明</p> <h2 id="prop-types"><a href="#prop-types" class="header-anchor">#</a> prop-types</h2> <p>用来设置组件的接受的 props，以及一些限制</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code>component<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  onClick<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>func<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  completed<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>bool<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  text<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="redux"><a href="#redux" class="header-anchor">#</a> redux</h2> <h3 id="action"><a href="#action" class="header-anchor">#</a> action</h3> <blockquote><p>定义了动作的类型，以及每个动作所需要的参数</p></blockquote> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token constant">ADD_TODO</span><span class="token punctuation">,</span> text <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="reducers"><a href="#reducers" class="header-anchor">#</a> reducers</h3> <blockquote><p>使用 switch...case 匹配 action 类型的动作，修改相对应的 state</p></blockquote> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">visibilityFilter</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> initialState<span class="token punctuation">.</span>visibilityFilter<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">SET_VISIBILITY_FILTER</span><span class="token operator">:</span>
      <span class="token keyword">return</span> action<span class="token punctuation">.</span>filter<span class="token punctuation">;</span> <span class="token comment">//返回的值即为更新的后的state</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用<code>combineReducers</code>封装多个<code>reducer</code></p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> todoApp <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  visibilityFilter<span class="token punctuation">,</span>
  todos<span class="token punctuation">,</span>
  articleList
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="store"><a href="#store" class="header-anchor">#</a> store</h3> <p>在前面的章节中，我们学会了使用 <code>action</code> 来描述“发生了什么”，和使用 <code>reducers</code> 来根据 <code>action</code> 更新 <code>state</code> 的用法。</p> <p>Store 就是把它们联系到一起的对象。Store 有以下职责：</p> <ul><li>维持应用的 <code>state</code>；</li> <li>提供 <code>getState()</code> 方法获取 <code>state</code>；</li> <li>提供 <code>dispatch(action)</code> 方法更新 <code>state</code>；</li> <li>通过 <code>subscribe(listener)</code> 注册监听器;</li> <li>通过 <code>subscribe(listener)</code> 返回的函数注销监听器。</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/shimingw/vpblog/edit/master/docs/JavaScript/02.React/01.React学习笔记.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新于:</span> <span class="time">2020-1-28 10:17:52 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/2019-01-13-JavaScript-ES6-ES6学习笔记/" class="prev">ES6</a></span> <span class="next"><a href="/docs/2018-04-15-JavaScript-React-redux/">Redux</a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="pace  pace-inactive" style="display:none;" data-v-57a75e74><div data-progress-text="100%" data-progress="99" class="pace-progress" style="transform:translate3d(0%, 0px, 0px);" data-v-57a75e74><div class="pace-progress-inner" data-v-57a75e74></div></div></div><div class="my-popup" style="display:none;" data-v-3414bdeb><div class="my-popup-container" data-v-3414bdeb><div class="my-popup-exit" data-v-3414bdeb></div> <img src="" alt data-v-3414bdeb></div></div><!----><!----><div></div></div></div>
    <script src="/assets/js/app.3e6f12d9.js" defer></script><script src="/assets/js/2.4c1ec6c0.js" defer></script><script src="/assets/js/10.ed8ed320.js" defer></script><script src="/assets/js/5.c16b3c5d.js" defer></script>
  </body>
</html>
