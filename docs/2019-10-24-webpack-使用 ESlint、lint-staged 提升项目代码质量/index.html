<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 ESlint、lint-staged 提升项目代码质量 | 嘻哈工程师</title>
    <meta name="description" content="嘻哈工程师的博客">
    <link rel="icon" href="/favicon.ico">
  <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/assets/css/0.styles.f497a715.css" as="style"><link rel="preload" href="/assets/js/app.1b0e8bfd.js" as="script"><link rel="preload" href="/assets/js/2.4c1ec6c0.js" as="script"><link rel="preload" href="/assets/js/37.2ec10155.js" as="script"><link rel="preload" href="/assets/js/5.c16b3c5d.js" as="script"><link rel="prefetch" href="/assets/js/10.42e73687.js"><link rel="prefetch" href="/assets/js/11.d5f7028c.js"><link rel="prefetch" href="/assets/js/12.35a8f19a.js"><link rel="prefetch" href="/assets/js/13.f0ee1cd9.js"><link rel="prefetch" href="/assets/js/14.40ce4884.js"><link rel="prefetch" href="/assets/js/15.f6d7f7a5.js"><link rel="prefetch" href="/assets/js/16.ee3c9d28.js"><link rel="prefetch" href="/assets/js/17.b236e85c.js"><link rel="prefetch" href="/assets/js/18.f58c47d7.js"><link rel="prefetch" href="/assets/js/19.ef1506ad.js"><link rel="prefetch" href="/assets/js/20.f1801f3e.js"><link rel="prefetch" href="/assets/js/21.3b5245cc.js"><link rel="prefetch" href="/assets/js/22.09300826.js"><link rel="prefetch" href="/assets/js/23.0a5f4eef.js"><link rel="prefetch" href="/assets/js/24.0d5ab444.js"><link rel="prefetch" href="/assets/js/25.5270f716.js"><link rel="prefetch" href="/assets/js/26.88a9d023.js"><link rel="prefetch" href="/assets/js/27.37b0d261.js"><link rel="prefetch" href="/assets/js/28.63d3faf1.js"><link rel="prefetch" href="/assets/js/29.2c72f0d4.js"><link rel="prefetch" href="/assets/js/3.f95c2fa6.js"><link rel="prefetch" href="/assets/js/30.1cf29fdc.js"><link rel="prefetch" href="/assets/js/31.81940ec7.js"><link rel="prefetch" href="/assets/js/32.8f8379e3.js"><link rel="prefetch" href="/assets/js/33.3060360f.js"><link rel="prefetch" href="/assets/js/34.adfe965d.js"><link rel="prefetch" href="/assets/js/35.65c192c5.js"><link rel="prefetch" href="/assets/js/36.525ccfd4.js"><link rel="prefetch" href="/assets/js/38.9b03bd65.js"><link rel="prefetch" href="/assets/js/39.8f311cbd.js"><link rel="prefetch" href="/assets/js/4.e118c4d9.js"><link rel="prefetch" href="/assets/js/40.4ed38670.js"><link rel="prefetch" href="/assets/js/41.1da76018.js"><link rel="prefetch" href="/assets/js/42.46afc9e7.js"><link rel="prefetch" href="/assets/js/43.4c003ffb.js"><link rel="prefetch" href="/assets/js/44.f4b021b4.js"><link rel="prefetch" href="/assets/js/45.d271d826.js"><link rel="prefetch" href="/assets/js/46.4a122cc5.js"><link rel="prefetch" href="/assets/js/47.e5e85646.js"><link rel="prefetch" href="/assets/js/48.71dd0ec2.js"><link rel="prefetch" href="/assets/js/49.413f7496.js"><link rel="prefetch" href="/assets/js/50.10e0c21e.js"><link rel="prefetch" href="/assets/js/51.68ef68a7.js"><link rel="prefetch" href="/assets/js/52.a5d554ba.js"><link rel="prefetch" href="/assets/js/53.6fac0f52.js"><link rel="prefetch" href="/assets/js/54.28e267a2.js"><link rel="prefetch" href="/assets/js/55.bd0b3f81.js"><link rel="prefetch" href="/assets/js/56.7d347f6b.js"><link rel="prefetch" href="/assets/js/57.9f16b70b.js"><link rel="prefetch" href="/assets/js/58.97b29959.js"><link rel="prefetch" href="/assets/js/59.aa3db1f9.js"><link rel="prefetch" href="/assets/js/6.52ca20b6.js"><link rel="prefetch" href="/assets/js/60.9b48cf76.js"><link rel="prefetch" href="/assets/js/7.309640e0.js"><link rel="prefetch" href="/assets/js/8.fec440f3.js"><link rel="prefetch" href="/assets/js/9.bfab17b2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f497a715.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">嘻哈工程师</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">最新</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/shimingw/vpblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">最新</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/shimingw/vpblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/docs/2017-04-06-webpack-webpack/" class="sidebar-link">webpack</a></li><li><a href="/docs/2019-10-26-webpack-webpack-plugin/" class="sidebar-link">webpack-plugin</a></li><li><a href="/docs/2018-07-12-webpack-打包工具运行原理/" class="sidebar-link">打包工具运行原理</a></li><li><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/" class="active sidebar-link">使用ESlint、lint-staged提升项目代码质量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#lint-staged" class="sidebar-link">lint-staged</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#配置" class="sidebar-link">配置</a></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#内部流程" class="sidebar-link">内部流程</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#prettier" class="sidebar-link">prettier</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#安装-2" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#参数" class="sidebar-link">参数</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#eslint" class="sidebar-link">ESLint</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#安装-3" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#初始化" class="sidebar-link">初始化</a></li><li class="sidebar-sub-header"><a href="/docs/2019-10-24-webpack-使用 ESlint、lint-staged 提升项目代码质量/#配置文件" class="sidebar-link">配置文件</a></li></ul></li></ul></li><li><a href="/docs/2019-06-14-webpack-Babel学习笔记/" class="sidebar-link">Babel学习笔记</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="lint-staged"><a href="#lint-staged" class="header-anchor">#</a> lint-staged</h2> <p>根据<code>package.json</code>中配置的<code>husky</code>工具（例如 <a href="https://prettier.io/" target="_blank" rel="noopener noreferrer">Prettier<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://eslint.org/" target="_blank" rel="noopener noreferrer">ESlint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>） 对暂存区的代码进行检查</p> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev lint-staged@next
</code></pre></div><h3 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h3> <h4 id="lint-staged-配置"><a href="#lint-staged-配置" class="header-anchor">#</a> lint-staged 配置</h4> <ul><li>可以直接在<code>package.json</code>中配置</li></ul> <div class="language- extra-class"><pre class="language-text"><code>  &quot;lint-staged&quot;: {
    &quot;**/src/**/*.{js,vue}&quot;: [	//配置过滤规则
      &quot;prettier --write --single-quote --no-semi&quot;,	//配置检查规则
      &quot;eslint --fix&quot;,
      &quot;git add&quot;
    ]
  }
</code></pre></div><ul><li>还可以通过<code>.lintstagedrc</code>、<code>.lintstagedrc.js</code>、<code>lint-staged.config.js</code>默认配置文件进行配置</li></ul> <div class="language- extra-class"><pre class="language-text"><code>//通过配置文件可以编写更个性的过滤规则
module.exports = {
  '**/*.js?(x)': filenames =&gt; filenames.map(filename =&gt; `prettier --write '${filename}'`)
}
</code></pre></div><h4 id="husky-配置"><a href="#husky-配置" class="header-anchor">#</a> husky 配置</h4> <p>最后需要在恰当的时候调用<code>lint-staged</code>，一般是在<code>commit</code>之前</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;husky&quot;: {
    &quot;hooks&quot;: {
      &quot;pre-commit&quot;: &quot;lint-staged&quot;
    }
 }
</code></pre></div><h3 id="内部流程"><a href="#内部流程" class="header-anchor">#</a> 内部流程</h3> <ol><li>git commit 时，触发 husky 钩子，用过钩子去执行 lint-staged 插件</li> <li>lint-staged 根据 eslint、prettier 配置规则对文件进行修复和检查</li> <li>如果文件通过检查则成功 commit</li> <li>如果检查未通过会在控制台提示错误</li></ol> <h2 id="prettier"><a href="#prettier" class="header-anchor">#</a> prettier</h2> <p>一个代码格式化程序<a href="https://prettier.io/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="安装-2"><a href="#安装-2" class="header-anchor">#</a> 安装</h3> <div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev --save-exact prettier
</code></pre></div><h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <p><code>prettier</code>可以将文件以你定义的规则去格式化文件，如果你没有配置任何规则，则以<code>prettier</code>的默认规则进行文件格式化</p> <div class="language- extra-class"><pre class="language-text"><code>npx prettier --write xx.js
</code></pre></div><h3 id="参数"><a href="#参数" class="header-anchor">#</a> 参数</h3> <ul><li>--wirte：就地格式化文件</li> <li><a href="https://prettier.io/docs/en/options.html" target="_blank" rel="noopener noreferrer">more<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="eslint"><a href="#eslint" class="header-anchor">#</a> ESLint</h2> <h3 id="安装-3"><a href="#安装-3" class="header-anchor">#</a> 安装</h3> <p>一个代码检查工具，它使用<code>AST</code>去分析代码中的模式</p> <p>如果你的代码有不符合规则的地方，他都会提示出来</p> <div class="language- extra-class"><pre class="language-text"><code>npm install --save-dev eslint
</code></pre></div><h3 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h3> <p>可以帮助开发者快速生成一个<code>eslint</code>的配置文件，并且自动安装相关依赖</p> <p>开发者可以根据个人项目的特点，去生<code>eslint</code>规则</p> <div class="language- extra-class"><pre class="language-text"><code>node_modules/.bin/eslint --init
// 如果全局安装了 可以直接 eslint --init
</code></pre></div><h3 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h3> <div class="language- extra-class"><pre class="language-text"><code>module.exports = {
  env: {
    browser: true,
    es6: true
  },
  extends: [
    'plugin:vue/essential',
    'standard'
  ],
  globals: {
    Atomics: 'readonly',
    SharedArrayBuffer: 'readonly'
  },
  parserOptions: {
    ecmaVersion: 2018,
    sourceType: 'module'
  },
  plugins: [
    'vue'
  ],
  rules: {
  }
}
</code></pre></div><ul><li><p><code>env</code>: Environments，指定代码的运行环境。不同的运行环境，全局变量不一样，指明运行环境这样 ESLint 就能识别特定的全局变量。同时也会开启对应环境的语法支持，例如：es6。</p></li> <li><p><code>parser</code>：ESLint 默认使用 Espree 作为其解析器，但它并不能很好的适应 React 环境，所以刚才安装了 babel-eslint 用来代替默认的解析器，在配置里这么写<code>&quot;parser&quot;: &quot;babel-eslint&quot;</code>。</p></li> <li><p><code>plugins</code>：顾名思义就是插件，插件是单独的 npm 包，命名一般以<code>eslint-plugin</code>开头，写的时候用字符串数组的形式，可以省略<code>eslint-plugin</code>开头。plugins 一般包含一个或多个规则配置，可以在 extends 中引入。</p></li> <li><p><code>extends</code>：ESLint 不需要自行定义大量的规则，因为很多规则已被分组作为一个规则配置。</p></li> <li><p><code>rules</code>：这里可以对规则进行细致的定义了，覆盖之前前面说的 extends 中定义的规则。例如 - <code>indent</code>就是对缩进的修改。<code>&quot;indent&quot;: [&quot;error&quot;,4]</code> 前面一项代表错误等级，第二项是具体配置，有些规则有第三项选项，例如 indent 就有 <code>{ &quot;SwitchCase&quot;: 1 }</code>，代表对 switch 语句采取什么样的缩进策略，如果不设默认是 0。具体可以定义什么 rules，可以<a href="https://link.jianshu.com/?t=https://eslint.org/docs/rules/" target="_blank" rel="noopener noreferrer">参考这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <p>错误等级有三级 <code>0</code>，<code>1</code>，<code>2</code>，分别代表<code>off</code>，<code>warning</code>，<code>error</code>。error 错误会终止 lint-staged 执行。</p> <ul><li><code>globals</code>：全局变量，当访问未定义的变量时，no-undef 规则将发出警告。如果你想在一个文件里使用全局变量，推荐你定义这些全局变量，这样 ESLint 就不会发出警告了。你可以使用注释或在配置文件中定义全局变量。</li> <li><code>parserOptions</code>：EsLint 通过 parserOptions，允许指定校验的 ecma 的版本，及 ecma 的一些特性</li></ul> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;parserOptions&quot;: {
        &quot;ecmaVersion&quot;: 6, //指定ECMAScript支持的版本，6为ES6
        &quot;sourceType&quot;: &quot;module&quot;, //指定来源的类型，有两种”script”或”module”
        &quot;ecmaFeatures&quot;: {
            &quot;jsx&quot;: true//启动JSX
        },
    }
}
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/shimingw/vpblog/edit/master/docs/webpack/04.使用ESlint、lint-staged提升项目代码质量.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新于:</span> <span class="time">2020-1-28 10:17:52 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/2018-07-12-webpack-打包工具运行原理/" class="prev">打包工具运行原理</a></span> <span class="next"><a href="/docs/2019-06-14-webpack-Babel学习笔记/">Babel学习笔记</a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="pace  pace-inactive" style="display:none;" data-v-57a75e74><div data-progress-text="100%" data-progress="99" class="pace-progress" style="transform:translate3d(0%, 0px, 0px);" data-v-57a75e74><div class="pace-progress-inner" data-v-57a75e74></div></div></div><div class="my-popup" style="display:none;" data-v-3414bdeb><div class="my-popup-container" data-v-3414bdeb><div class="my-popup-exit" data-v-3414bdeb></div> <img src="" alt data-v-3414bdeb></div></div><!----><!----><div></div></div></div>
    <script src="/assets/js/app.1b0e8bfd.js" defer></script><script src="/assets/js/2.4c1ec6c0.js" defer></script><script src="/assets/js/37.2ec10155.js" defer></script><script src="/assets/js/5.c16b3c5d.js" defer></script>
  </body>
</html>
